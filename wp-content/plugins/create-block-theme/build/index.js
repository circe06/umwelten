(()=>{"use strict";const e=window.wp.element;function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},t.apply(this,arguments)}const n=window.wp.components,l=window.wp.i18n,a=(0,e.createContext)(),o={heading:{text:(0,l.__)("The quick brown fox jumps over the lazy dog.","create-block-theme"),size:40,lineHeight:1.1,margin:"0.5em 0",component:"h2"},sentence:{text:(0,l.__)("Incredible as it may seem, I believe that the Aleph of Garay Street was a false Aleph.","create-block-theme"),size:24,lineHeight:1.3,margin:"0.5em 0",component:"p"},paragraph:{text:(0,l.__)("First a glass of pseudo-cognac, he ordered, and then down you dive into the cellar. Let me warn you, you'll have to lie flat on your back. Total darkness, total immobility, and a certain ocular adjustment will also be necessary. From the floor, you must focus your eyes on the nineteenth step. Once I leave you, I'll lower the trapdoor and you'll be quite alone. You needn't fear the rodents very much though I know you will. In a minute or two, you'll see the Aleph, the microcosm of the alchemists and Kabbalists, our true proverbial friend, the multum in parvo!","create-block-theme"),size:16,lineHeight:1.5,margin:"0.5em 0",component:"p"}};function c(t){let{children:n}=t;const[l,c]=(0,e.useState)(localStorage.getItem("cbt_default-demo-type")||"sentence"),[r,m]=(0,e.useState)(localStorage.getItem("cbt_default-demo-text")||o[l].text),[i,s]=(0,e.useState)(parseInt(localStorage.getItem("cbt_default-demo-font-size"))||o[l].size),d=e=>{m(e),localStorage.setItem("cbt_default-demo-text",e)},u=e=>{s(e),localStorage.setItem("cbt_default-demo-font-size",e)},f=e=>{d(o[e||l].text),u(o[e||l].size)},[h,p]=(0,e.useState)(JSON.parse(localStorage.getItem("cbt_families-open"))||[]);return(0,e.createElement)(a.Provider,{value:{demoText:r,handleDemoTextChange:d,resetDefaults:f,demoType:l,handleDemoTypeChange:e=>{c(e),localStorage.setItem("cbt_default-demo-type",e),f(e)},demoFontSize:i,handleDemoFontSizeChange:u,familiesOpen:h,handleToggleFamily:e=>{let t=[];t=h.includes(e)?h.filter((t=>t!==e)):[...h,e],p(t),localStorage.setItem("cbt_families-open",JSON.stringify(t))}}},n)}const r=function(t){let{style:n}=t;const{demoText:l,demoType:c,demoFontSize:r}=(0,e.useContext)(a),m=o[c].component,i={...n,fontSize:`${r}px`,lineHeight:o[c].lineHeight,margin:o[c].margin};return(0,e.createElement)("div",null,(0,e.createElement)(m,{style:i},l))},{__}=wp.i18n;function m(t){let{fontFamily:l,fontWeight:a,fontStyle:o,deleteFontFace:c,shouldBeRemoved:m,isFamilyOpen:i}=t;const s={fontFamily:l,fontStyle:o,fontWeight:a?String(a).split(" ")[0]:"normal"};return m?null:(0,e.createElement)("tr",{className:"font-face"},(0,e.createElement)("td",null,o),(0,e.createElement)("td",null,a),(0,e.createElement)("td",{className:"demo-cell"},(0,e.createElement)(r,{style:s})),c&&(0,e.createElement)("td",null,(0,e.createElement)(n.Button,{variant:"tertiary",onClick:c,tabindex:i?0:-1},__("Remove","create-block-theme"))))}m.defaultProps={fontWeight:"normal",fontStyle:"normal"};const i=m,{__:s,_n}=wp.i18n,d=function(l){let{fontFamily:o,fontFamilyIndex:c,deleteFontFamily:r,deleteFontFace:m}=l;const{familiesOpen:d,handleToggleFamily:u}=(0,e.useContext)(a),f=d.includes(o.name)||d.includes(o.fontFamily),h=()=>{u(o.name||o.fontFamily)};if(o.shouldBeRemoved)return null;const p=!!o.fontFace&&!!o.fontFace.length;return(0,e.createElement)("table",{className:"wp-list-table widefat table-view-list"},(0,e.createElement)("thead",{onClick:h},(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:"font-family-head"},(0,e.createElement)("div",null,(0,e.createElement)("strong",null,o.name||o.fontFamily),p&&(0,e.createElement)("span",{className:"variants-count"}," ","( ",o.fontFace.length," ",_n("Variant","Variants",o.fontFace.length,"create-block-theme")," ",")")),(0,e.createElement)("div",null,(0,e.createElement)(n.Button,{variant:"tertiary",onClick:e=>{e.stopPropagation(),r(c)}},s("Remove Font Family","create-block-theme")),(0,e.createElement)(n.Button,{onClick:h},(0,e.createElement)(n.Icon,{icon:f?"arrow-up-alt2":"arrow-down-alt2"})))))),(0,e.createElement)("tbody",{className:"font-family-contents"},(0,e.createElement)("tr",{className:"container"},(0,e.createElement)("td",{className:" slide "+(f?"open":"close")},(0,e.createElement)("table",{className:"wp-list-table widefat striped table-view-list"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",null,s("Style","create-block-theme")),(0,e.createElement)("td",null,s("Weight","create-block-theme")),(0,e.createElement)("td",{className:"preview-head"},s("Preview","create-block-theme")),p&&(0,e.createElement)("td",null))),(0,e.createElement)("tbody",null,p&&o.fontFace.map(((n,l)=>n.shouldBeRemoved?null:(0,e.createElement)(i,t({},n,{fontFamilyIndex:c,fontFaceIndex:l,key:`fontface${l}`,deleteFontFace:()=>m(c,l),isFamilyOpen:f})))),!p&&o.fontFamily&&(0,e.createElement)(i,t({},o,{isFamilyOpen:f}))))))))},u=window.wp.primitives,f=(0,e.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(u.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})),h=function(){const{demoText:t,handleDemoTextChange:o,demoType:c,handleDemoTypeChange:r,demoFontSize:m,handleDemoFontSizeChange:i,resetDefaults:s}=(0,e.useContext)(a);return(0,e.createElement)("div",{className:"demo-text-input"},(0,e.createElement)("div",{className:"container"},(0,e.createElement)(n.SelectControl,{label:(0,l.__)("Preview type","create-block-theme"),onChange:r,value:c},(0,e.createElement)("option",{value:"heading"},(0,l.__)("Heading","create-block-theme")),(0,e.createElement)("option",{value:"sentence"},(0,l.__)("Sentence","create-block-theme")),(0,e.createElement)("option",{value:"paragraph"},(0,l.__)("Paragraph","create-block-theme"))),(0,e.createElement)(n.__experimentalInputControl,{label:"Demo text",value:t,onChange:o}),(0,e.createElement)("div",null,(0,e.createElement)(n.RangeControl,{label:(0,l.__)("Font size (px)","create-block-theme"),value:m,onChange:i,min:8,max:140,withInputField:!0})),(0,e.createElement)("div",null,(0,e.createElement)(n.Button,{variant:"secondary",icon:f,onClick:()=>{s("sentence"),r("sentence")}},(0,l.__)("Reset","create-block-theme")))))},{__:p,sprintf:y}=wp.i18n,g=function(){const t=document.querySelector("#theme-fonts-json"),l=document.querySelector("#manage-fonts-form"),a=t.innerHTML,o=JSON.parse(a),[c,r]=(0,e.useState)(o),[m,i]=(0,e.useState)({fontFamilyIndex:void 0,fontFaceIndex:void 0}),[s,u]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1);(0,e.useEffect)((()=>{void 0===m.fontFamilyIndex&&void 0===m.fontFaceIndex||l.submit()}),[c]);const E=()=>{g(!f)};function v(e,t){i({fontFamilyIndex:e,fontFaceIndex:t},u(!0))}const b=c[m.fontFamilyIndex],F=c[m.fontFamilyIndex]?.fontFace?.[m.fontFaceIndex];return(0,e.createElement)(e.Fragment,null,f&&(0,e.createElement)(n.Modal,{title:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n.Icon,{icon:"info"})," ",p("Info","create-block-theme")),onRequestClose:E},(0,e.createElement)("p",null,p("This is a list of your font families listed in the theme.json file of your theme.","create-block-theme")),(0,e.createElement)("p",null,p("If your theme.json makes reference to fonts providers other than local they may not be displayed correctly.","create-block-theme"))),(0,e.createElement)("p",{className:"help"},p("These are the fonts currently embedded in your theme ","create-block-theme"),(0,e.createElement)(n.Button,{onClick:E,style:{padding:"0",height:"1rem"}},(0,e.createElement)(n.Icon,{icon:"info"}))),(0,e.createElement)("input",{type:"hidden",name:"new-theme-fonts-json",value:JSON.stringify(c)}),(0,e.createElement)(n.__experimentalConfirmDialog,{isOpen:s,onConfirm:function(){u(!1),void 0!==m.fontFamilyIndex&&void 0!==m.fontFaceIndex?function(){const{fontFamilyIndex:e,fontFaceIndex:t}=m,n=c.reduce(((n,l,a)=>{const{fontFace:o=[],...c}=l;return e===a&&1===o.filter((e=>!e.shouldBeRemoved)).length&&(c.shouldBeRemoved=!0),c.fontFace=o.map(((n,l)=>e===a&&t===l?{...n,shouldBeRemoved:!0}:n)),[...n,c]}),[]);r(n)}(m.fontFamilyIndex,m.fontFaceIndex):function(e){const t=c.map(((t,n)=>n===e?{...t,shouldBeRemoved:!0}:t));r(t)}(m.fontFamilyIndex)},onCancel:function(){i({}),u(!1)}},void 0!==m?.fontFamilyIndex&&void 0!==m?.fontFaceIndex?(0,e.createElement)("h3",null,y(
// translators: %1$s: Font Style, %2$s: Font Weight, %3$s: Font Family
p('Are you sure you want to delete "%1$s - %2$s" variant of "%3$s" from your theme?',"create-block-theme"),F?.fontStyle,F?.fontWeight,b?.fontFamily)):(0,e.createElement)("h3",null,y(
// translators: %s: Font Family
p('Are you sure you want to delete "%s" from your theme?',"create-block-theme"),b?.fontFamily)),(0,e.createElement)("p",null,p("This action will delete the font definition and the font file assets from your theme.","create-block-theme"))),(0,e.createElement)(h,null),(0,e.createElement)("div",{className:"font-families"},c.map(((t,n)=>(0,e.createElement)(d,{fontFamily:t,fontFamilyIndex:n,key:`fontfamily${n}`,deleteFontFamily:v,deleteFontFace:v})))))},E=window.wp.data,v=window.wp.coreData,b=function(t){let{font:n,variant:l,isSelected:a,handleToggle:o}=t;const c=l.includes("italic")?"italic":"normal",m="regular"===l||"italic"===l?"400":l.replace("italic",""),i=n.files[l].replace("http://","https://"),s={fontFamily:n.family,fontStyle:c,fontWeight:m};return(0,e.useEffect)((()=>{new FontFace(n.family,`url( ${i} )`,{style:c,weight:m}).load().then((function(e){document.fonts.add(e)})).catch((function(e){console.error(e)}))}),[n,l]),(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:""},(0,e.createElement)("input",{type:"checkbox",name:"google-font-variant",value:l,checked:a,onClick:o})),(0,e.createElement)("td",{className:""},m),(0,e.createElement)("td",{className:""},c),(0,e.createElement)("td",{className:"demo-cell"},(0,e.createElement)(r,{style:s})))};function F(e){return e.includes("italic")?"italic":"normal"}function w(e){return"regular"===e||"italic"===e?"400":e.replace("italic","")}const S=JSON.stringify({}),_=function(){const[t,a]=(0,e.useState)({}),[o,c]=(0,e.useState)(null),[r,m]=(0,e.useState)([]),[i,s]=(0,e.useState)(S),d=document.querySelector("#nonce").value;(0,e.useEffect)((()=>{(async()=>{const e=await fetch(createBlockTheme.googleFontsDataUrl),t=await e.json();a(t)})()}),[]),(0,e.useEffect)((()=>{m([]),s(S)}),[o]),(0,e.useEffect)((()=>{if(o&&r.length){const e=r.map((e=>{return{style:F(e),weight:w(e),src:(t=o.files[e],t.replace("http://","https://"))};var t})),t={family:o.family,faces:e};s(JSON.stringify(t))}else s(S)}),[r]);const u=(0,E.useSelect)((e=>e(v.store).getCurrentTheme()),null);return(0,e.createElement)("div",{className:"wrap google-fonts-page"},(0,e.createElement)("h1",{className:"wp-heading-inline"},(0,l.__)("Add Google fonts to your theme","create-block-theme")),(0,e.createElement)("h3",null,(0,l.__)("Add Google fonts assets and font face definitions to your currently active theme","create-block-theme")," ","(",u?.name.rendered,")"),!t?.items&&(0,e.createElement)("p",null,(0,e.createElement)(n.Spinner,null),(0,e.createElement)("span",null,(0,l.__)("Loading Google fonts data…","create-block-theme"))),t?.items&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"select-font"},(0,e.createElement)(n.SelectControl,{label:(0,l.__)("Select Font","create-block-theme"),name:"google-font",onChange:e=>{c(t.items[e])}},(0,e.createElement)("option",{value:null},(0,l.__)("Select a font…","create-block-theme")),t.items.map(((t,n)=>(0,e.createElement)("option",{key:n,value:n},t.family))))),(0,e.createElement)(h,null),o&&(0,e.createElement)("p",null,(0,l.__)("Select the font variants you want to include:","create-block-theme")),o&&(0,e.createElement)("table",{className:"wp-list-table widefat striped table-view-list",id:"google-fonts-table"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:""},(0,e.createElement)("input",{type:"checkbox",onClick:()=>{r.length?m([]):m(o.variants)},checked:r.length===o?.variants.length})),(0,e.createElement)("td",{className:""},(0,l.__)("Weight","create-block-theme")),(0,e.createElement)("td",{className:""},(0,l.__)("Style","create-block-theme")),(0,e.createElement)("td",{className:""},(0,l.__)("Preview","create-block-theme")))),(0,e.createElement)("tbody",null,o.variants.map(((t,n)=>(0,e.createElement)(b,{font:o,variant:t,key:`font-variant-${n}`,isSelected:r.includes(t),handleToggle:()=>(e=>{r.includes(e)?m(r.filter((t=>t!==e))):m([...r,e])})(t)}))))),(0,e.createElement)("form",{encType:"multipart/form-data",action:"",method:"POST"},(0,e.createElement)("input",{type:"hidden",name:"selection-data",value:i}),(0,e.createElement)("input",{type:"submit",value:(0,l.__)("Add google fonts to your theme","create-block-theme"),className:"button button-primary",disabled:0===r.length}),(0,e.createElement)("input",{type:"hidden",name:"nonce",value:d}))))};function k(){let t=null;switch(new URLSearchParams(document.location.search).get("page")){case"manage-fonts":t=g;break;case"add-google-font-to-theme-json":t=_;break;default:t=()=>(0,e.createElement)("h1",null,"This page is not implemented yet.")}return(0,e.createElement)(c,null,(0,e.createElement)(t,null))}window.addEventListener("load",(function(){(0,e.render)((0,e.createElement)(k,null),document.querySelector("#fonts-app"))}),!1)})();